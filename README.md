# Charge_Classification

需要环境：tensorflow1.4，Python3.6，numpy，random，collections，csv

先运行tool里面的数据处理函数，然后更改train里面的文件读取路径，直接运行train脚本，会在屏幕上打印出训练信息以及训练进度。

PS：建议将文件里的文件路径都改为相对路径。

基于裁判文书的罪名及刑期预测——文本分类任务

# 1、任务描述

司法系统的大数据平台是国内很多学者都比较关注的一点，其中，如何根据一段犯罪事实描述来预测该案件的罪名以及刑期，是大数据平台当中比较重要的一部分，也是比较难的一部分。

给定一篇犯罪事实描述文本，通过模型计算来给出罪名及刑期。

# 2、思路

判决预测是一个典型的下游任务，具体领域内的知识对任务有巨大的帮助作用，所以我们从刑法中提取出了关于罪名和刑期的知识，我们采用三元组的方式，对比于知识图谱的三元组结构，知识库结构为（charge，plot，value），即（罪名，情节，刑期）。

可以将罪名和刑期类比为知识图谱中的头实体和尾实体，将情节视为连接头尾实体的关系（路径）。

知识表示：知识图谱的表示学习旨在学习实体和关系的向量化表示,其关键是合理定义知识图谱中关于事实（三元组< h,r,t >）的损失函数 ƒr(h,t) 。通常情况下，当事实 < h,r,t > 成立时，期望最小化 ƒr(h,t)。

min┬⁡(∑_((ℎ,𝑟,𝑡)∈𝑂)▒〖𝑓_𝑟 (ℎ,𝑡) 〗)

其中 O 表示知识图谱中所有事实的集合。不同的表示学习可以使用不同的原则和方法定义相应的损失函数。

基于翻译的表示学习：

其代表性工作 TransE 模型通过向量空间的向量翻译来刻画实体与关系之间的相关性。该模型假定，若 < h,r,t > 成立则尾部实体 t 的嵌入表示应该接近头部实体 h 加上关系向量 r 的嵌入表示，即 h+r≈t。

当三元组成立时，得分较低，反之得分较高。TransE 在处理简单的 1-1 关系（即关系两端连接的实体数比率为 1：1）时是非常有效的，但在处理 N-1、1-N 以及 N-N 的复杂关系时性能则显著降低。针对这些复杂关系，Wang 提出了 TransH 模型通过将实体投影到关系所在超平面,从而习得实体在不同关系下的不同表示。Lin 提出了 TransR 模型通过投影矩阵将实体投影到关系子空间，从而习得不同关系下的不同实体表示。

transE存在的问题：

transE算法在处理自反关系，以及多对一、一对多、多对多关系中，会使得一些不同的实体具有相同或者相似的向量。其根本原因在于，出现在多个关系中的同一个实体的表示是相同的。

transH进行表示学习

2014年Wang Z, Zhang J, Feng J, et al.提出了transH模型，其核心思想是为每种关系定义一个超平面和一个关系向量，利用实体在超平面上的投影和关系向量来相互确定。

最终，我们选择transH进行知识图谱的表示学习，然后将知识图谱的表示与模型融合在一起。

多任务学习：

多任务学习是一种类似于迁移学习的思路，多个相关的任务能够相互支撑，相互学习，从而提高各自的准确率，同时任务间的拓扑关系也是模型中的重点。

所以，分类器上我们采用多任务拓扑结构，先预测罪名，从罪名中，根据刑法知识库，能够提炼出来关于刑期的知识，从而为刑期预测提供先验知识，提高准确率。

# 3、模型创新点

  1、模型中融入司法领域知识图谱，利用先验知识提高模型效果。
  
  2、多任务拓扑结构，使得各任务间的相关关系得到进一步的利用，而不是简单的使用平行多任务。
  
  3、通过attention机制，从编码后的向量中提取出不同的信息，然后将信息添加到罪名及刑期的向量当中。
  
  4、进一步利用知识图谱中的剩余信息，传统知识图谱是利用头实体和尾实体来指定尾实体，只有尾实体输出，本模型进一步利用了头实体和关系的表示意义来作为其他任务的补充信息，进一步提高模型效果。

# 4、实验结果

罪名预测93%，刑期预测91%
